    if [type] == "syslog-f5" {
        grok {     
          break_on_match => false
          match => [ "message", "\A%{SYSLOG5424PRI}%{SYSLOGTIMESTAMP} slot1\/%{HOSTNAME:logsource} %{LOGLEVEL:severity_label} %{SYSLOGPROG}: %{GREEDYDATA:info}" ]
          add_tag => "grokked_syslog_f5"      
        } 
        mutate {
            gsub => [ 
                "severity_label", "err", "error",
                "severity_label", "info", "informational",
                "severity_label", "crit", "critical"
            ]
        }  
    }
    if [program] == "dcc" {
            grok {          
              patterns_dir => "/usr/local/nagioslogserver/logstash/patterns"
              match => [ "info", "%{F5SEQ:f5_sequence}: %{GREEDYDATA:info}violations: %{GREEDYDATA:f5_violations}. HTTP protocol compliance sub violations: %{GREEDYDATA:f5_http_violations}. Evasion techniques sub violations: %{GREEDYDATA:f5_evasion_violations}. Web services security sub violations: %{GREEDYDATA:f5_web_svc_violations}. Virus name: %{GREEDYDATA:f5_virusname}. Support id: %{GREEDYDATA:f5_supportid}, source ip: %{IPNA:f5_sourceip}, xff ip: %{IPNA:f5_xffip}, source port: %{NUMBER:f5_sourceport}, destination ip: %{IPNA:f5_destinationip}, destination port: %{NUMBER:f5_destinationport}, route_domain: %{NUMBER:f5_routedomain}, HTTP classifier: %{GREEDYDATA:f5_http_classifier}, scheme %{SCHEME:f5_scheme}, geographic location:%{GREEDYDATA:f5_geolocation}, request: %{GREEDYDATA:f5_request}, username:%{GREEDYDATA:f5_username}, session_id: %{GREEDYDATA:f5_sessionid}" ]          
              match => [ "info", "%{GREEDYDATA:info}" ]
              remove_tag => "grokked_syslog_f5"
              add_tag => "grokked_syslog_f5_dcc"
              overwrite => [ "info" ]
              }
        }
    
    if [program] == "apd" {
            grok {          
              patterns_dir => "/usr/local/nagioslogserver/logstash/patterns"
              match => [ "info", "%{F5SEQ:f5_sequence}: %{F5ID:f5_seqid}: %{GREEDYDATA:info}" ]          
              match => [ "info", "%{GREEDYDATA:info}" ]
              remove_tag => "grokked_syslog_f5"
              add_tag => "grokked_syslog_f5_apd"
              overwrite => [ "info" ]
              }
        }
    
    if [program] == "tmm" {
            grok {          
              patterns_dir => "/usr/local/nagioslogserver/logstash/patterns"
              match => [ 
                  "info", "%{F5SEQ:f5_sequence}: %{F5ID:f5_seqid}: %{GREEDYDATA:info}",
                  "info", "%{GREEDYDATA:info}"
              ]
              overwrite => [ "info" ]
              remove_tag => "grokked_syslog_f5"
              add_tag => "grokked_syslog_f5_tmm"
              }
            grok {
              match => [
                  "info" , "Session statistics - bytes in: %{NUMBER:f5_sessionbytesin}, bytes out: %{NUMBER:f5_sessionbytesout}",
                  "info" , "Received client info - Type: %{HOSTNAME:f5_sessionbrowser} Version: %{NUMBER:f5_sessionbrowserversion} Platform: %{HOSTNAME:f5_sessionplatform} CPU: %{GREEDYDATA}",
                  "info" , "New session from client IP %{IP:f5_sessionclientip} \(%{GREEDYDATA:f5_sessionlocation}\) at VIP %{IP:f5_sessionvipip} Listener %{GREEDYDATA:f5_sessionlistener} %{GREEDYDATA}",
                  "info", "%{GREEDYDATA:info}"
              ]
              overwrite => [ "info" ]
            }
        }
    
    if [program] == "tmm1" {
            grok {          
              patterns_dir => "/usr/local/nagioslogserver/logstash/patterns"
              match => [ "info", "%{F5SEQ:f5_sequence}: %{F5ID:f5_seqid}: %{GREEDYDATA:info}" ]          
              match => [ "info", "%{GREEDYDATA:info}" ]
              remove_tag => "grokked_syslog_f5"
              add_tag => "grokked_syslog_f5_tmm1"
              overwrite => [ "info" ]
              }
        }
    
    if [program] == "tmm2" {
            grok {          
              patterns_dir => "/usr/local/nagioslogserver/logstash/patterns"
              match => [ "info", "%{F5SEQ:f5_sequence}: %{F5ID:f5_seqid}: %{GREEDYDATA:info}" ]          
              match => [ "info", "%{GREEDYDATA:info}" ]
              remove_tag => "grokked_syslog_f5"
              add_tag => "grokked_syslog_f5_tmm2"
              overwrite => [ "info" ]
              }
        }
    
    if [program] == "tmm3" {
            grok {          
              patterns_dir => "/usr/local/nagioslogserver/logstash/patterns"
              match => [ "info", "%{F5SEQ:f5_sequence}: %{F5ID:f5_seqid}: %{GREEDYDATA:info}" ]          
              match => [ "info", "%{GREEDYDATA:info}" ]
              remove_tag => "grokked_syslog_f5"
              add_tag => "grokked_syslog_f5_tmm3"
              overwrite => [ "info" ]
              }
        }
    
    if [type] == "syslog-f5" and [program] == "sshd" {
            grok {          
              patterns_dir => "/usr/local/nagioslogserver/logstash/patterns"
              match => [ "info", "Accepted keyboard-interactive/pam for %{USERNAME:f5_ssh_username} from %{IP:f5_ssh_sourceip} port %{NUMBER:f5_ssh_port} ssh2" ]  
              match => [ "info", "pam_unix(sshd:session): session opened for user %{USERNAME:f5_ssh_username} by (uid={USERNAME:f5_ssh_username_uid})" ]      
              match => [ "info", "pam_unix(sshd:session): session closed for user %{USERNAME:f5_ssh_username}" ]   
              match => [ "info", "%{GREEDYDATA:info}" ]
              remove_tag => "grokked_syslog_f5"
              add_tag => "grokked_syslog_f5_sshd"
              overwrite => [ "info" ]
              }
        }